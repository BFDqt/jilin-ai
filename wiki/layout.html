<!doctype html>
<html lang="en" data-theme="light">

{# 定义页面类型变量 - 统一管理页面类型判断逻辑 #}
{% set page_title = self.title() %}
{% set is_home_page = (page_title == "Home") %}
{% set is_members_page = (page_title == "Meet Our Team") %}
{% set is_content_page = (not is_home_page and not is_members_page) %}

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Favicon -->
  <link rel="icon" href="https://static.igem.wiki/teams/6032/favicon/jilinai.ico" type="image/x-icon">

  <link rel="shortcut icon" href="https://static.igem.wiki/teams/6032/favicon/jilinai.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://static.igem.wiki/teams/6032/favicon/jilinai.ico">

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/" />

  <!-- Bootstrap CSS -->
  <link href="{{ url_for('static', filename = 'css/bootstrap.min.css') }}" rel="stylesheet">

  <!-- FontAwesome CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename = 'css/font-awesome.min.css') }}">

  <!-- Google Fonts for narrative style -->
  <link href="{{ url_for('static', filename = 'css/google-fonts.css') }}" rel="stylesheet">


  <!-- HXTII CSS for Markdown Rendering -->

  <link href="{{ url_for('static', filename = 'HXTII/css/HXTII.css') }}" rel="stylesheet">

  <link href="{{ url_for('static', filename = 'HXTII/css/common.css') }}" rel="stylesheet">

  <link href="{{ url_for('static', filename = 'HXTII/css/bamboo.css') }}" rel="stylesheet">

  <!-- AOS (Animate On Scroll) CSS -->
  <link href="{{ url_for('static', filename = 'css/aos.css') }}" rel="stylesheet">

  <!-- Custom CSS - Modular Structure -->
  <link href="{{ url_for('static', filename = 'css/base.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename = 'css/navbar.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename = 'css/layout.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename = 'css/components.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename = 'css/animations.css') }}" rel="stylesheet">

  <!-- Page-specific styles -->
  {% block styles %}{% endblock %}

  <title>{% block title %}{% endblock %} | Jilin-AI - iGEM 2025</title>

</head>

<body{% if is_members_page %} class="members-page"{% endif %}>
  <!-- Skip to main content link for keyboard navigation -->
  <a href="#main-content" class="skip-link visually-hidden-focusable">Skip to main content</a>

  <!-- Neural Network Loading Animation -->
  <div id="loading-page" class="neural-loading-page" role="status" aria-live="polite" aria-label="Page loading">
    <div class="loader-container">
      <svg id="nn-svg" viewBox="0 0 360 220" role="img" aria-label="Neural network visualization loading animation">
        <title>Neural Network Loading Animation</title>
        <defs>
          <!-- 亮色模式渐变 -->
          <linearGradient id="grad" gradientUnits="userSpaceOnUse" x1="0" y1="110" x2="360" y2="110">
            <stop offset="0%" stop-color="#2563eb" />
            <stop offset="40%" stop-color="#3b82f6" />
            <stop offset="70%" stop-color="#8b5cf6" />
            <stop offset="100%" stop-color="#7c3aed" />
          </linearGradient>
          <!-- 暗色模式渐变 -->
          <linearGradient id="grad-dark" gradientUnits="userSpaceOnUse" x1="0" y1="110" x2="360" y2="110">
            <stop offset="0%" stop-color="#2563eb" />
            <stop offset="40%" stop-color="#3b82f6" />
            <stop offset="70%" stop-color="#8b5cf6" />
            <stop offset="100%" stop-color="#7c3aed" />
          </linearGradient>
        </defs>
        <!-- Neural network structure generated dynamically by JS -->
      </svg>
    </div>
    <div class="loading-container">
      <div class="loading-title" aria-hidden="true">BIOMNIGEM</div>
      <div class="loading-subtitle" id="loading-status">Loading...</div>
    </div>
    <!-- Screen reader accessible loading message -->
    <div class="visually-hidden" aria-live="assertive" id="loading-message">
      Page is loading, please wait. This may take a few moments.
    </div>
  </div>

  <!-- Navigation -->
  {% include 'menu.html' %}

  {% if is_home_page %}
  <!-- Special full-screen layout for Home page -->
  {% block home_content %}{% endblock %}
  {% elif is_members_page %}
  <!-- Special full-screen layout for Members page -->
  {% block members_content %}{% endblock %}
  {% else %}
  <!-- Modern Hero Header -->
  <header class="modern-hero-header" role="banner">
    <div class="hero-background">
      <div class="hero-particles"></div>
      <div class="hero-gradient"></div>
    </div>
    <div class="hero-content">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-10 text-center">
            <div class="hero-title-container">
              <h1 class="hero-title" data-aos="fade-up">{{ self.title() }}</h1>
              <div class="hero-title-underline"></div>
            </div>
            {% if self.lead() %}
            <p class="hero-subtitle" data-aos="fade-up" data-aos-delay="200">{% block lead %}{% endblock %}</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    <div class="hero-scroll-indicator">
      <div class="scroll-arrow"></div>
    </div>
  </header>

  <!-- Page Content -->
  <div class="container">
    <div class="row">
      <!-- Table of Contents -->
      <aside class="toc-index col-lg-2 col-md-3" role="complementary" aria-label="Table of Contents">
        <nav aria-label="Table of Contents" class="toc-container">
          <div id="toc-content">
            <p class="toc-loading">Loading table of contents...</p>
          </div>
        </nav>
      </aside>
      <!-- Main Content -->
      <main class="text-content col-lg-10 col-md-9 d-flex flex-column align-items-start" id="main-content" role="main">
        <article class="content-section">
          <!-- HXTII Markdown Render Container -->
          <div id="HXT"></div>
          {% block page_content %}{% endblock %}
        </article>
      </main>
    </div>
  </div>
  {% endif %}

  <!-- Footer: MUST mention license AND have a link to team wiki's repository on gitlab.igem.org -->
  {% include 'footer.html' %}
  <!-- jQuery (required for HXTII) -->
  <script src="{{ url_for('static', filename = 'js/jquery-3.6.0.min.js') }}"></script>

  <!-- Bootstrap Bundle with Popper -->
  <script src="{{ url_for('static', filename = 'js/bootstrap.bundle.min.js') }}"></script>
  <!-- AOS (Animate On Scroll) JS -->
  <script src="{{ url_for('static', filename = 'js/aos.js') }}"></script>
  <!-- Table of Contents Script -->
  <script src="{{ url_for('static', filename = 'js/table-of-contents.js') }}"></script>
  <!-- Theme Toggle Script -->
  <script src="{{ url_for('static', filename = 'js/theme-toggle.js') }}"></script>
  <!-- Site Search Script -->
  <!-- <script src="{{ url_for('static', filename = 'site-search.js') }}"></script> -->

  <!-- HXTII Library for Markdown Rendering -->
  <script type="text/javascript" src="{{ url_for('static', filename = 'HXTII/js/HXTII.js') }}"></script>

  <!-- Initialize AOS -->
  <script>
    AOS.init({
      duration: 1000,
      easing: 'ease-out-cubic',
      once: true
    });
  </script>

  <!-- Page-specific scripts -->
  {% block scripts %}{% endblock %}

  <!-- Back to Top Button -->
  <button id="back-to-top" class="back-to-top-btn" type="button" aria-label="返回顶部" title="点击返回页面顶部">
    <div class="back-to-top-container">
      <!-- 环形进度条 -->
      <svg class="back-to-top-progress" viewBox="0 0 60 60" aria-hidden="true">
        <circle class="back-to-top-progress-bg" cx="30" cy="30" r="28" fill="none" stroke="rgba(255, 255, 255, 0.2)"
          stroke-width="3" stroke-linecap="round"></circle>
        <circle class="back-to-top-progress-bar" cx="30" cy="30" r="28" fill="none" stroke="#4f46e5" stroke-width="3"
          stroke-linecap="round" stroke-dasharray="175.929" stroke-dashoffset="175.929"></circle>
      </svg>
      <!-- 箭头图标 -->
      <svg class="back-to-top-icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 19V5M5 12L12 5L19 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" />
      </svg>
    </div>
    <span class="visually-hidden">点击返回页面顶部</span>
  </button>

  <script>

    // Back to Top Button Logic

    window.addEventListener('DOMContentLoaded', function () {

      const backToTopButton = document.getElementById('back-to-top');



      // 检测页面滚动

      window.addEventListener('scroll', function () {

        if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {

          document.body.classList.add('scrolled');

        } else {

          document.body.classList.remove('scrolled');

        }

      });



      // 点击按钮回到页面顶部

      if (backToTopButton) {

        backToTopButton.addEventListener('click', function (event) {

          event.preventDefault();

          document.body.scrollTop = 0; // 对于 Safari

          document.documentElement.scrollTop = 0; // 对于 Chrome, Firefox, IE 和 Opera

        });

      }

    });

  </script>



  {% if not is_home_page %}

  <!-- HXTII Markdown Rendering for Content Pages -->

  <script>

    (function () {

      // Only initialize HXTII if not on Home page

      var hxtDom = document.getElementById('HXT');

      if (!hxtDom) return;



      // Check if page has markdown content to render

      if (typeof hxtiiContent !== 'undefined' || typeof markdownString !== 'undefined') {



        if (!window.hasOwnProperty("hxtIsMarkdown") && typeof hxtiiContent !== 'undefined') {

          // Render as HXTII content

          var hxt = new HXTII({

            el: hxtDom,

            content: hxtiiContent,

            renderComplete: function () {

              updateTableOfContents();

            }

          });

        } else if (typeof markdownString !== 'undefined') {

          // Render as Markdown

          var hxt = new HXTII({

            el: hxtDom,

            markdownContent: markdownString,

            markdown: true,

            renderComplete: function () {

              updateTableOfContents();

            }

          });

        }



        // Update TOC from HXTII rendered content

        function updateTableOfContents() {

          if (!window.hxt || !window.hxt.titleGradeList) return;



          var tocEl = document.getElementById("toc-content");

          if (!tocEl) return;



          // Clear loading message

          tocEl.innerHTML = '';



          // Build TOC from HXTII title list (level 1 headings)

          for (var i = 0; i < window.hxt.titleGradeList.length; i++) {

            if (window.hxt.titleGradeList[i] == 1) {

              var item = document.createElement("div");

              item.className = "toc-item";



              var link = document.createElement("a");

              link.href = "#";

              link.className = "toc-link";



              // Extract text from rendered content

              var textContent = '';

              if (window.hxt.childList[i].children &&

                window.hxt.childList[i].children[0] &&

                window.hxt.childList[i].children[0].children &&

                window.hxt.childList[i].children[0].children[0]) {

                textContent = window.hxt.childList[i].children[0].children[0].innerText;

              } else {

                textContent = window.hxt.childList[i].innerText || 'Section ' + (i + 1);

              }

              link.textContent = textContent;



              // Add click handler with closure to capture correct index

              (function (index) {

                link.addEventListener("click", function (e) {

                  e.preventDefault();

                  var targetElement = window.hxt.childList[index];

                  if (targetElement) {

                    var offsetTop = targetElement.offsetTop - 120; // Account for fixed header

                    window.scrollTo({

                      top: offsetTop,

                      behavior: 'smooth'

                    });

                  }

                });

              })(i);



              item.appendChild(link);

              tocEl.appendChild(item);

            }

          }

        }

      }

    })();

  </script>

  {% endif %}



</body>

</html>